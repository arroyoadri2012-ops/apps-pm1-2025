<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pensamiento Matemático 1 — Razones, Proporciones y Porcentajes — Mtra. Adriana Arroyo</title>
<link rel="manifest" href="manifest.json">
<style>
  :root{--bg:#0b1117;--card:#0f172a;--ink:#f8fafc;--muted:#cbd5e1;--border:#1e293b;--pill:#0b1220;}
  *{box-sizing:border-box} body{margin:0;padding:16px;background:var(--bg);color:var(--ink);font-family:system-ui,Segoe UI,Roboto,Arial}
  h1{margin:0 0 6px 0;font-size:22px}
  .credit{margin:6px 0 12px 0;color:var(--muted);font-size:14px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px;margin-bottom:12px}
  label{display:block;margin-bottom:6px;color:var(--muted);font-size:14px}
  input,select,button{width:100%;padding:14px;border-radius:12px;border:1px solid var(--border);background:#0b1220;color:#f8fafc;font-size:18px}
  .pill{display:inline-block;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:var(--pill);margin-right:6px;font-size:14px}
  .op{font-weight:700;font-size:18px;line-height:1.45;min-height:84px;margin:8px 0 10px 0}
  .box{background:#0b1320;border:1px solid #1b2b46;border-radius:10px;padding:10px;margin-top:10px}
  .btns{display:flex;gap:10px;margin-top:10px}.btns button{flex:1}
  .primary{background:#34d399;color:#0a1b12;font-weight:800;border:none;cursor:pointer}
  .muted{background:#0b1220;color:#e2e8f0;border:1px solid #223049}
</style>
</head>
<body>
<nav style="padding:10px 0;border-bottom:1px solid var(--border);margin-bottom:12px;display:flex;flex-wrap:wrap;gap:8px;">
    <a href="pm1_razones_prop_porcent_OFFLINE.html" style="background:#34d399;color:var(--bg);padding:6px 10px;border-radius:6px;text-decoration:none;font-size:14px;font-weight:700;">Razones</a>
    <a href="pm1_regla_de_tres_OFFLINE.html" style="background:#a78bfa;color:var(--bg);padding:6px 10px;border-radius:6px;text-decoration:none;font-size:14px;font-weight:700;">Regla 3</a>
    <a href="pm1_mcm_mcd_quiz_OFFLINE.html" style="background:#60a5fa;color:var(--bg);padding:6px 10px;border-radius:6px;text-decoration:none;font-size:14px;font-weight:700;">MCM/MCD</a>
    <a href="pm1_exponentes_OFFLINE (2).html" style="background:#fbbf24;color:var(--bg);padding:6px 10px;border-radius:6px;text-decoration:none;font-size:14px;font-weight:700;">Exponentes</a>
    <a href="pm1_exponentes_avanzados_OFFLINE_RESET.html" style="background:#38bdf8;color:var(--bg);padding:6px 10px;border-radius:6px;text-decoration:none;font-size:14px;font-weight:700;">Exp. Avanz</a>
</nav>

<div class="card">
  <h1>PENSAMIENTO MATEMÁTICO 1: Razones, Proporciones y Porcentajes</h1>
  <p class="credit">by Mtra. Adriana Arroyo • Versión offline (sin internet) • Tap únicamente • Tolerancia ±0.1</p>
</div>
<div class="card">
  <label>Nombre</label><input id="studentName" placeholder="Nombre y apellidos">
  <label>Grupo</label><input id="studentGroup" placeholder="p. ej., 1°A">
  <label>Modo</label><select id="mode">
    <option value="mixed" selected>Mixto (razón + proporción + porcentaje)</option>
    <option value="ratio">Solo razones</option>
    <option value="proportion">Solo proporciones</option>
    <option value="percent">Solo porcentajes</option>
  </select>
  <label>Temporizador (minutos, opcional)</label><select id="timer">
    <option value="0" selected>Sin tiempo</option><option>5</option><option>8</option><option>10</option>
  </select>
  <button id="startBtn" class="primary">Iniciar (10 ítems)</button>
</div>
<div class="card">
  <div id="operation" class="op">—</div>
  <input id="answer" type="text" inputmode="text" autocomplete="off" autocorrect="off" spellcheck="false" placeholder="Escribe la respuesta (número)">

  <div class="btns">
    <button id="checkBtn" class="primary">Comprobar</button>
    <button id="nextBtn" class="muted">Siguiente</button>
  </div>
  <div id="feedback" style="min-height:110px;margin-top:10px"></div>
</div>
<div class="card">
  <span id="counter" class="pill">Ítem —/10</span>
  <span id="score" class="pill">Aciertos 0</span>
  <span id="streak" class="pill">Racha 0</span>
  <span id="time" class="pill" style="display:none">Tiempo 00:00</span>
</div>

<script>
(function(){
  function $(s){return document.querySelector(s)}
  function rand(a,b){return Math.floor(Math.random()*(b-a+1))+a}
  function choice(arr){return arr[rand(0,arr.length-1)]}
  function fixed2(x){return Number(x.toFixed(2));}

  // Conjuntos de datos amigables para cálculo mental
  function pctOptions(){return [5,10,15,20,25,40,50];}
  function priceBase(){return choice([80,90,100,120,140]);}

  var ratioContexts=[
    function(){ var girls=rand(6,12), boys=rand(6,12); var val=fixed2(girls/boys);
      return {type:'ratio', text:'En un grupo hay '+girls+' mujeres y '+boys+' hombres. ¿Razón mujeres:hombres en decimal?<br><strong>Respuesta = ?</strong>',
      answer:String(val),
      steps:'<div class="box"><strong>Razón</strong><br>'+girls+'/'+boys+' = <strong>'+val+'</strong>.</div>'};},
    function(){ var ahorro=rand(100,200), meta=ahorro*rand(2,4); var val=fixed2(ahorro/meta);
      return {type:'ratio', text:'Adriana ahorró $'+ahorro+' de una meta de $'+meta+'. ¿Qué parte representa su ahorro (decimal)?<br><strong>Respuesta = ?</strong>',
      answer:String(val),
      steps:'<div class="box"><strong>Razón</strong><br>'+ahorro+'/'+meta+' = <strong>'+val+'</strong>.</div>'};}
  ];

  var proportionContexts=[
    function(){ var q1=rand(2,4), unit=rand(10,20), total1=q1*unit; var q2=q1; while(q2===q1){ q2=rand(3,6); }
      var ans=fixed2(total1*q2/q1);
      return {type:'proportion', text:'En una tienda, '+q1+' libretas cuestan $'+total1+'. ¿Cuánto costarán '+q2+' libretas?<br><strong>Respuesta = ?</strong>',
      answer:String(ans),
      steps:'<div class="box"><strong>Regla de tres (directa)</strong><br>x = ('+total1+'×'+q2+')/'+q1+' = <strong>$'+ans+'</strong>.</div>'};},
    function(){ var invMes=rand(200,400), meses1=rand(2,4), rend1=invMes*meses1; var meses2=meses1; while(meses2===meses1){ meses2=rand(3,6); }
      var ans=fixed2(rend1*meses2/meses1);
      return {type:'proportion', text:'Un ahorro rinde '+rend1+' puntos en '+meses1+' meses (proporcional). ¿Cuántos en '+meses2+' meses?<br><strong>Respuesta = ?</strong>',
      answer:String(ans),
      steps:'<div class="box"><strong>Regla de tres (directa)</strong><br>x = ('+rend1+'×'+meses2+')/'+meses1+' = <strong>'+ans+'</strong>.</div>'};}
  ];

  var percentContexts=[
    function(){ var base=priceBase(), pct=choice(pctOptions()), ans=fixed2(base*(1-pct/100));
      return {type:'percent', text:'Una mochila cuesta $'+base+' y tiene '+pct+'% de descuento. ¿Precio final?<br><strong>Respuesta = ?</strong>',
      answer:String(ans),
      steps:'<div class="box"><strong>Descuento</strong><br>'+base+'×(1 - '+pct+'%) = <strong>$'+ans+'</strong>.</div>'};},
    function(){ var base=priceBase(), pct=choice(pctOptions()), ans=fixed2(base*(1+pct/100));
      return {type:'percent', text:'Un ahorro de $'+base+' crece '+pct+'% en un mes. ¿Monto final?<br><strong>Respuesta = ?</strong>',
      answer:String(ans),
      steps:'<div class="box"><strong>Aumento</strong><br>'+base+'×(1 + '+pct+'%) = <strong>$'+ans+'</strong>.</div>'};},
    function(){ var deuda=priceBase()+60, pct=choice([10,20,25,50]); var pago=fixed2(deuda*pct/100); var ans=fixed2(deuda - pago);
      return {type:'percent', text:'Tienes una deuda de $'+deuda+'. Si pagas el '+pct+'%, ¿cuánto queda por pagar?<br><strong>Respuesta = ?</strong>',
      answer:String(ans),
      steps:'<div class="box"><strong>Deuda</strong><br>Pago = '+deuda+'×'+pct+'% = '+pago+'; restante = <strong>$'+ans+'</strong>.</div>'};}
  ];

  function buildItem(mode){
    var m=mode; if(m==='mixed') m=choice(['ratio','proportion','percent']);
    var list=(m==='ratio')?ratioContexts:(m==='proportion')?proportionContexts:percentContexts;
    var p=choice(list)();
    return { type:p.type, text:p.text, correct:String(p.answer), explain:p.steps };
  }

  var s={items:[],i:0,score:0,streak:0,left:0,timerId:null};
  var op=$('#operation'), ans=$('#answer'), fb=$('#feedback'), counter=$('#counter'), score=$('#score'), streak=$('#streak'), timeEl=$('#time');

  function startTimer(mins){
    if(mins<=0){ timeEl.style.display='none'; return; }
    s.left = mins*60; timeEl.style.display='inline-block'; tick();
    s.timerId = setInterval(function(){ s.left--; tick(); if(s.left<=0){ clearInterval(s.timerId); finish(); }}, 1000);
  }
  function tick(){ var m = Math.max(0, Math.floor(s.left/60)); var sec = Math.max(0, s.left%60);
    timeEl.textContent = 'Tiempo '+String(m).padStart(2,'0')+':'+String(sec).padStart(2,'0'); }

  function gen(){ var arr=[], m=$('#mode').value; for(var i=0;i<10;i++) arr.push(buildItem(m)); s.items=arr; s.i=0; s.score=0; s.streak=0; fb.innerHTML=''; ans.value=''; }
  function render(){ var it=s.items[s.i]; op.innerHTML=it.text; counter.textContent='Ítem '+(s.i+1)+'/10'; fb.innerHTML=''; ans.value=''; }
  function check(){ var it=s.items[s.i]; var val=String(ans.value).replace(',','.').trim(); var nv=parseFloat(val), nc=parseFloat(it.correct);
    var ok=(!isNaN(nv)&&!isNaN(nc))?(Math.abs(nv-nc)<=0.1):(val===it.correct);
    if(ok){ s.score++; s.streak++; fb.innerHTML='<p style="color:#22c55e">¡Bien!</p>'+it.explain; }
    else{ s.streak=0; fb.innerHTML='<p style="color:#ef4444">Incorrecto.</p><p>Solución: <strong>'+it.correct+'</strong></p>'+it.explain; }
